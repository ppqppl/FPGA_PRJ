/*
天空之城，j=100 4/4拍的节奏，每一小拍2.5ms 
*/

module sky(clk,rst_n,beep);

	input clk;
	input rst_n;
	
	output beep;
	
	reg [31:0]counter_arr;
	wire [31:0]counter_ccr;
	
	reg [20:0]delay;
	reg [4:0]number;
	reg [7:0]beat;
	
	parameter delay_max = 1249999;
	
	localparam 
		L1 = 191130,
		L2 = 170241,
		L3 = 151698,
		L4 = 143183,
		L5 = 127550,
		L6 = 113635,
		L7 = 101234;
/*		
		M1 = 191130,
		M2 = 191130,
		M3 = 191130,
		M4 = 191130,
		M5 = 191130,
		M6 = 191130,
		M7 = 191130,
*/		

	assign counter_ccr = counter_arr >> 1;
	
	pwn pwn1(
		.clk(clk),
		.rst_n(rst_n),
		.cnt_en(1'b1),
		.counter_arr(counter_arr),
		.counter_ccr(counter_ccr),
		.o_pwn(beep)
	);
	
	always@(posedge clk or negedge rst_n)
	if(!rst_n)
		delay1 <= 21'd0;
	else if (delay == 0)
		delay1 <= delay_max;
	else 
		delay1 <= delay - 1'b1;
		
	always@(posedge clk or negedge rst_n)
	if(!rst_n)
		beat <= 8'd0;
	else if(delay1 == 0)
		beat <= beat + 1'b1;
	else if(beat == 8'd127)
		beat <= 8'd0;
	else 
		beat <= beat;
		
	always@(*)
		case(beat)
			
		endcase 
endmodule